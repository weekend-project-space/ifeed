# AI 优先 RSS 阅读器：接口文档 (API 文档)

本接口文档描述了前端与后端交互所使用的 RESTful API。

> **分页说明**
> 所有带有 `page` / `size` 查询参数的接口均返回 Spring Data `Page` 风格的响应，示例结构如下（页码从 0 开始）：
>
> ```json
> {
>   "content": [ ... ],
>   "pageable": {
>     "pageNumber": 0,
>     "pageSize": 10,
>     "sort": {
>       "sorted": false,
>       "unsorted": true,
>       "empty": true
>     }
>   },
>   "totalElements": 42,
>   "totalPages": 5,
>   "last": false,
>   "first": true,
>   "size": 10,
>   "number": 0,
>   "sort": {
>     "sorted": false,
>     "unsorted": true,
>     "empty": true
>   },
>   "numberOfElements": 10,
>   "empty": false
> }
> ```

## 1. 用户认证

### 注册
- 方法：`POST /api/auth/register`
- 请求体：
```json
{ "username": "string", "password": "string" }
```
- 响应体：
```json
{ "token": "string", "userId": "string" }
```

### 登录
- 方法：`POST /api/auth/login`
- 请求体：
```json
{ "username": "string", "password": "string" }
```
- 响应体：
```json
{ "token": "string", "userId": "string" }
```

### 获取用户信息
- 方法：`GET /api/user`
- 认证：`Bearer <token>`
- 响应体：
```json
{ "userId": "string", "username": "string" }
```

## 2. 订阅管理

### 添加订阅
- 方法：`POST /api/subscriptions`
- 认证：`Bearer <token>`
- 请求体：
```json
{ "feedUrl": "string" }
```
- 响应体：
```json
{ "message": "Subscription added." }
```

### 获取订阅列表
- 方法：`GET /api/subscriptions`
- 认证：`Bearer <token>`
- 响应体：
```json
[
  { "feedId": "string", "title": "string", "url": "string" }
]
```

### 取消订阅
- 方法：`DELETE /api/subscriptions/:feedId`
- 认证：`Bearer <token>`
- 响应体：
```json
{ "message": "Subscription removed." }
```

## 3. 文章内容

### 获取文章列表
- 方法：`GET /api/articles`
- 认证：`Bearer <token>`
- 查询参数：`page`（默认 0）、`size`（默认 10）、`sort`（可选，如 `publishedAt,desc`）
- 响应体：
```json
{
  "content": [
    {
      "id": "string",
      "title": "string",
      "link": "string",
      "summary": "string",
      "feedTitle": "string",
      "publishedAt": "2024-03-01T10:00:00Z",
      "tags": ["AI", "推荐"],
      "timeAgo": "2 小时前"
    }
  ],
  "pageable": { "pageNumber": 0, "pageSize": 10, "sort": { "sorted": true, "unsorted": false, "empty": false } },
  "totalElements": 42,
  "totalPages": 5,
  "last": false,
  "first": true,
  "size": 10,
  "number": 0,
  "sort": { "sorted": true, "unsorted": false, "empty": false },
  "numberOfElements": 10,
  "empty": false
}
```

### 获取文章详情
- 方法：`GET /api/articles/:articleId`
- 认证：`Bearer <token>`
- 响应体：
```json
{
  "id": "string",
  "title": "string",
  "content": "string",
  "summary": "string",
  "feedTitle": "string",
  "publishedAt": "2024-03-01T10:00:00Z",
  "tags": ["AI", "推荐"]
}
```

## 4. 用户行为

### 收藏文章
- 方法：`POST /api/user/collections/:articleId`
- 认证：`Bearer <token>`
- 响应体：
```json
{ "message": "Article collected." }
```

### 取消收藏
- 方法：`DELETE /api/user/collections/:articleId`
- 认证：`Bearer <token>`
- 响应体：
```json
{ "message": "Article uncollected." }
```

### 获取收藏列表
- 方法：`GET /api/user/collections`
- 认证：`Bearer <token>`
- 查询参数：`page`（默认 0）、`size`（默认 10）、`sort`（可选，如 `collectedAt,desc`）
- 响应体：
```json
{
  "content": [
    {
      "articleId": "string",
      "title": "string",
      "collectedAt": "2024-03-01T09:30:00Z"
    }
  ],
  "pageable": { "pageNumber": 0, "pageSize": 10, "sort": { "sorted": true, "unsorted": false, "empty": false } },
  "totalElements": 12,
  "totalPages": 2,
  "last": false,
  "first": true,
  "size": 10,
  "number": 0,
  "sort": { "sorted": true, "unsorted": false, "empty": false },
  "numberOfElements": 10,
  "empty": false
}
```

### 记录阅读历史
- 方法：`POST /api/user/history`
- 认证：`Bearer <token>`
- 请求体：
```json
{ "articleId": "string", "readAt": "2024-03-01T10:20:00Z" }
```
- 说明：`readAt` 可选，未提供时由服务器记录当前时间。
- 响应体：
```json
{ "message": "History recorded." }
```

### 获取阅读历史列表
- 方法：`GET /api/user/history`
- 认证：`Bearer <token>`
- 查询参数：`page`（默认 0）、`size`（默认 10）、`sort`（默认 `readAt,desc`）
- 响应体：
```json
{
  "content": [
    {
      "articleId": "string",
      "title": "string",
      "readAt": "2024-03-01T10:20:00Z"
    }
  ],
  "pageable": { "pageNumber": 0, "pageSize": 10, "sort": { "sorted": true, "unsorted": false, "empty": false } },
  "totalElements": 58,
  "totalPages": 6,
  "last": false,
  "first": true,
  "size": 10,
  "number": 0,
  "sort": { "sorted": true, "unsorted": false, "empty": false },
  "numberOfElements": 10,
  "empty": false
}
```

## 5. 搜索

### 搜索文章
- 方法：`GET /api/search`
- 认证：`Bearer <token>`
- 查询参数：
  - `query`（关键词或自然语言，必填）
  - `type`（`keyword` 或 `semantic`，可选，默认 `keyword`）
  - `page`（默认 0）
  - `size`（默认 10）
- 响应体：
```json
{
  "content": [
    {
      "id": "string",
      "title": "string",
      "summary": "string",
      "score": 0.87
    }
  ],
  "pageable": { "pageNumber": 0, "pageSize": 10, "sort": { "sorted": false, "unsorted": true, "empty": true } },
  "totalElements": 23,
  "totalPages": 3,
  "last": false,
  "first": true,
  "size": 10,
  "number": 0,
  "sort": { "sorted": false, "unsorted": true, "empty": true },
  "numberOfElements": 10,
  "empty": false
}
```
