               ┌─────────────────────┐
               │     User Query       │
               │ "人工智能 NLP ..."   │
               └─────────┬───────────┘
                         │
                         ▼
             ┌─────────────────────┐
             │  Query Embedding     │
             │ (OpenAI / HF Model) │
             └─────────┬───────────┘
                         │
         ┌───────────────┴───────────────┐
         │                               │
         ▼                               ▼
 ┌─────────────────────┐        ┌─────────────────────┐
 │   BM25 Retrieval    │        │  Vector Retrieval    │
 │ tsvector @@ tsquery │        │ embedding <-> query │
 │ ts_rank_cd()        │        │ L2 / Cosine Distance│
 └─────────┬───────────┘        └─────────┬───────────┘
           │                                │
           └───────────┐   ┌──────────────┘
                       ▼   ▼
               ┌─────────────────────┐
               │  Hybrid Scoring      │
               │ bm25_score * w1 +    │
               │ vector_score * w2    │
               └─────────┬───────────┘
                         │
                         ▼
               ┌─────────────────────┐
               │ Top-K Candidate Docs │
               │  (e.g., 50 文档)     │
               └─────────┬───────────┘
                         │
                         ▼
               ┌─────────────────────┐
               │  Reranker Model      │
               │ Cross-Encoder / BGE  │
               │ Score & Reorder      │
               └─────────┬───────────┘
                         │
                         ▼
               ┌─────────────────────┐
               │  Final Top-N Docs    │
               │ 用于 RAG Prompt       │
               └─────────────────────┘
